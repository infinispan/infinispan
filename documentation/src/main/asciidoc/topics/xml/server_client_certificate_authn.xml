<security>
  <security-realms>
    <security-realm name="trust-store-realm">
      <server-identities>
        <ssl>
          <!-- Provides an SSL/TLS identity with a keystore that
               contains server certificates. -->
          <keystore path="server.p12"
                    relative-to="infinispan.server.config.path"
                    keystore-password="secret"
                    alias="server"/>
          <!-- Configures a trust store that contains client certificates
               or part of a certificate chain. -->
          <truststore path="trust.p12"
                      relative-to="infinispan.server.config.path"
                      password="secret"/>
        </ssl>
      </server-identities>
      <!-- Authenticates client certificates against the trust store. If you configure this, the trust store must contain the public certificates for all clients. -->
      <truststore-realm/>
    </security-realm>
  </security-realms>
</security>
<endpoints>
  <endpoint socket-binding="default"
            security-realm="trust-store-realm"
            require-ssl-client-auth="true">
    <hotrod-connector>
      <authentication>
        <sasl mechanisms="EXTERNAL"
              server-name="infinispan"
              qop="auth"/>
      </authentication>
    </hotrod-connector>
    <rest-connector>
      <authentication mechanisms="CLIENT_CERT"/>
    </rest-connector>
  </endpoint>
</endpoints>
