[id='rest_v2_cluster_stop']
= Stopping {brandname} Clusters
Shut down entire {brandname} clusters with `POST` requests.

[source,options="nowrap",subs=attributes+]
----
POST /rest/v2/cluster?action=stop
----

{brandname} responds with `200(OK)` and then performs an orderly shutdown of
the entire cluster.


[id='rest_v2_stop_cluster_server']
= Stopping Specific {brandname} Servers in Clusters
Shut down one or more specific servers in {brandname} clusters with `GET`
requests and the `?action=stop&server` parameter.

[source,options="nowrap",subs=attributes+]
----
POST /rest/v2/cluster?action=stop&server={server1_host}&server={server2_host}
----

{brandname} responds with `200(OK)`.

[id='rest_v2_backup_cluster']
= Backing Up {brandname} Clusters
Create backup archives, `application/zip`, that contain resources (caches, cache
configurations, counters, Protobuf schemas, scripts, and so on) currently
stored in the cache container for the cluster.

[source,options="nowrap",subs=attributes+]
----
POST /rest/v2/cluster/backups/{backupName}
----

Optionally include a JSON payload with your request that contains parameters
for the backup operation, as follows:

.JSON Parameters

|===
|Key |Required or Optional |Value

|`directory`
|OPTIONAL
|Specifies a location on the server to create and store the backup archive.

|===

[id='rest_v2_backup_cluster_list']
= Listing Backups
Retrieve the names of all backup operations that are in progress, completed, or
failed.

[source,options="nowrap",subs=attributes+]
----
GET /rest/v2/cluster/backups
----

[id='rest_v2_backup_cluster_head']
= Checking Backup Availability
Verify that a backup operation is complete. A `200` response indicates the
backup archive is available. A `202` response indicates the backup operation is
in progress.

[source,options="nowrap",subs=attributes+]
----
HEAD /rest/v2/cluster/backups/{backupName}
----

[id='rest_v2_backup_cluster_get']
= Downloading Backup Archives
Download backup archives from the server. A `200` response indicates the
backup archive is available. A `202` response indicates the backup operation is
in progress.

[source,options="nowrap",subs=attributes+]
----
GET /rest/v2/cluster/backups/{backupName}
----

[id='rest_v2_backup_cluster_delete']
= Deleting Backup Archives
Remove backup archives from the server. A `204` response indicates that the
backup archive is deleted. A `202` response indicates that the backup operation
is in progress but will be deleted when the operation completes.

[source,options="nowrap",subs=attributes+]
----
DELETE /rest/v2/cluster/backups/{backupName}
----

[id='rest_v2_restore_cluster']
= Restoring {brandname} Cluster Resources
Apply resources in a backup archive to restore {brandname} clusters.

[IMPORTANT]
====
You can restore resources only if the container name in the backup archive
matches the container name for the cluster.
====

[source,options="nowrap",subs=attributes+]
----
POST /rest/v2/cluster?action=restore
----

== Restoring from Backup Archives on {brandname} Server
Use the `application/json` content type with your POST request to back up from
an archive that is available on the server.

.JSON Parameters

|===
|Key |Required or Optional |Value

|`location`
|REQUIRED
|Specifies the path of the backup archive to restore.

|`resources`
|OPTIONAL
|Specifies the resources to restore, in JSON format. The default is to restore all resources. If you specify one or more resources, then {brandname} restores only those resources. See the _Resource Parameters_ table for more information.

|===

include::backup_resources.adoc[]

The following example restores all counters from a backup archive on the server:

[source,json,options="nowrap",subs=attributes+]
----
include::json_examples/rest_backup_restore_request_body.json[]
----

== Restoring from Local Backup Archives
Use the `multipart/form-data` content type with your POST request to upload a
local backup archive to the server.

.Form Data
|===
|Parameter |Content-Type |Required or Optional |Value

|`backup`
|`application/zip`
|REQUIRED
|Specifies the bytes of the backup archive to restore.
|===

.Example Request
----
Content-Type: multipart/form-data; boundary=5ec9bc07-f069-4662-a535-46069afeda32
Content-Length: 7798

--5ec9bc07-f069-4662-a535-46069afeda32
Content-Disposition: form-data; name="backup"; filename="testManagerRestoreParameters.zip"
Content-Type: application/zip
Content-Length: 7353

<zip-bytes>
--5ec9bc07-f069-4662-a535-46069afeda32--
----
